#!/bin/bash
## @licence MIT <http://opensource.org/licenses/MIT>
## @author Copyright (C) 2015 Liang Wang <liang.wang@cl.cam.ac.uk>

echo "Iving OpenVPN Access Server"
echo ${IVING_OPENVPN_SERVER_URL}

if [ ! -f "${OPENVPN}/pki/crl.pem" ]; then
    ovpn_genconfig -u udp://${IVING_OPENVPN_SERVER_URL}
    echo -e "OpenVPN has not been Initialised, you should run the following command:"
    echo -e "\tdocker run -v iving_openvpn_data:/etc/openvpn --log-driver=none --rm -it ryanrhymes/iving_openvpn:alpine ovpn_initpki"
    exit 1
fi

ovpn_run
